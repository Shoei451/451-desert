<!DOCTYPE html>
<html lang="ja">
<head>
<link rel="icon" href="images/favicon-solar.png" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Home â€” 451-Solarized</title>
<link rel="stylesheet" href="css/solar-index-style.css">
</head>
<body>

<!-- Auth Screen -->
<div id="authScreen" class="auth-screen">
    <div class="auth-card">
        <h1>ğŸ” 451-Solarized</h1>
        <p>Log in to access the tools</p>
        
        <div id="authError" class="error-message" style="display:none;"></div>
        
        <form id="authForm" class="auth-form">
            <div>
                <label for="authEmail">eMail adress</label>
                <input type="email" id="authEmail" required placeholder="your@email.com">
            </div>
            <div>
                <label for="authPassword">Password</label>
                <input type="password" id="authPassword" required placeholder="6æ–‡å­—ä»¥ä¸Š">
            </div>
            <button type="submit" id="authSubmit">Log in</button>
        </form>
        
        <div class="auth-toggle">
            <span id="authToggleText">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ãªã„å ´åˆ</span>
            <button type="button" id="authToggleBtn">æ–°è¦ç™»éŒ²</button>
        </div>
    </div>
</div>

<!-- Main App -->
<div class="app" id="mainApp">
    <!-- Theme Toggle & User Info -->
    <span class="logo-switches">
        <div class="user-info">
            <span id="userEmail"></span>
        </div>
        <button id="theme-toggle" title="ãƒ†ãƒ¼ãƒåˆ‡æ›¿">
            <svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
            <svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
        </button>
        <button id="logoutBtn">Log out</button>
    </span>

    <!-- Header -->
    <header>
        <img src="images/favicon-solar.png" width="300" height="300">
        <h1>451-solarized</h1>
        <p>solarized version / </p>
    </header>

    <!-- Introduction -->
    <section class="intro">
        <h2>Tools with auth</h2>
        <p>å„ãƒ„ãƒ¼ãƒ«ã¯åŒã˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã—ã¾ã™ã€‚<br>ãƒ‡ãƒ¼ã‚¿ã¯ã‚¯ãƒ©ã‚¦ãƒ‰ã«å®‰å…¨ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚</p>
    </section>

    <!-- Tools Cards -->
    <section class="cards-container">
        <a href="calendar-app.html" class="card">
            <div class="card-icon">ğŸ“†</div>
            <h3>å­¦ç”Ÿç”¨ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</h3>
            <p>èª²é¡Œãƒ»è©¦é¨“ãƒ»æˆæ¥­ã‚’ä¸€æ‹¬ç®¡ç†ã§ãã‚‹ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¢ãƒ—ãƒª</p>
        </a>
        
        <a href="ideas-app.html" class="card">
            <div class="card-icon">ğŸ’¡</div>
            <h3>Ideas Manager</h3>
            <p>ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è¨˜éŒ²ãƒ»æ•´ç†ãƒ»ç™ºå±•ã•ã›ã‚‹æ€è€ƒæ•´ç†ãƒ„ãƒ¼ãƒ«</p>
        </a>
        
        <!-- å°†æ¥çš„ã«è¿½åŠ ã™ã‚‹ãƒ„ãƒ¼ãƒ«ç”¨ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ -->
        <div class="card" style="opacity: 0.5; cursor: not-allowed;">
            <div class="card-icon">ğŸ“</div>
            <h3>ãƒãƒ¼ãƒˆç®¡ç†</h3>
            <p>è¿‘æ—¥å…¬é–‹äºˆå®š</p>
        </div>
        
        <div class="card" style="opacity: 0.5; cursor: not-allowed;">
            <div class="card-icon">ğŸ“Š</div>
            <h3>å­¦ç¿’è¨˜éŒ²</h3>
            <p>è¿‘æ—¥å…¬é–‹äºˆå®š</p>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <p>Get in touch: <a href="mailto:okamotoshoei451@gmail.com">okamotoshoei451@gmail.com</a></p>
    </footer>
</div>

<script type="module">
    import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'

    const SUPABASE_URL = 'https://abfuanjincelcyrlswsp.supabase.co'
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFiZnVhbmppbmNlbGN5cmxzd3NwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc4NjE4MDIsImV4cCI6MjA4MzQzNzgwMn0.OD7371E7A1ZRiqF6SGXnp2JSzPowg2zTt-V36GQ7x9A'
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

    const authScreen = document.getElementById('authScreen')
    const mainApp = document.getElementById('mainApp')
    const authForm = document.getElementById('authForm')
    const authError = document.getElementById('authError')
    const authToggleBtn = document.getElementById('authToggleBtn')
    const authToggleText = document.getElementById('authToggleText')
    const authSubmit = document.getElementById('authSubmit')
    const logoutBtn = document.getElementById('logoutBtn')
    const themeToggle = document.getElementById('theme-toggle')

    let isAuthMode = 'login'

    // Theme management
    const savedTheme = localStorage.getItem('theme')
    if (savedTheme === 'dark') {
        document.body.classList.add('dark')
    }

    themeToggle.onclick = () => {
        document.body.classList.toggle('dark')
        localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light')
    }

    // Auth toggle
    authToggleBtn.onclick = () => {
        isAuthMode = isAuthMode === 'login' ? 'signup' : 'login'
        if (isAuthMode === 'signup') {
            authSubmit.textContent = 'æ–°è¦ç™»éŒ²'
            authToggleText.textContent = 'ã™ã§ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã®å ´åˆ'
            authToggleBtn.textContent = 'ãƒ­ã‚°ã‚¤ãƒ³'
        } else {
            authSubmit.textContent = 'ãƒ­ã‚°ã‚¤ãƒ³'
            authToggleText.textContent = 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ãªã„å ´åˆ'
            authToggleBtn.textContent = 'æ–°è¦ç™»éŒ²'
        }
        authError.style.display = 'none'
    }

    // Auth form submit
    authForm.onsubmit = async (e) => {
        e.preventDefault()
        authError.style.display = 'none'
        authSubmit.disabled = true
        authSubmit.textContent = 'å‡¦ç†ä¸­...'

        const email = document.getElementById('authEmail').value
        const password = document.getElementById('authPassword').value

        try {
            let result
            if (isAuthMode === 'signup') {
                result = await supabase.auth.signUp({ email, password })
                if (result.error) throw result.error
                authError.textContent = 'ç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚ãƒ¡ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚'
                authError.style.background = '#e0f2e9'
                authError.style.color = '#0d5c2d'
                authError.style.display = 'block'
                authForm.reset()
            } else {
                result = await supabase.auth.signInWithPassword({ email, password })
                if (result.error) throw result.error
            }
        } catch (error) {
            authError.textContent = error.message
            authError.style.display = 'block'
            authSubmit.disabled = false
            authSubmit.textContent = isAuthMode === 'login' ? 'ãƒ­ã‚°ã‚¤ãƒ³' : 'æ–°è¦ç™»éŒ²'
        }
    }

    // Logout
    logoutBtn.onclick = async () => {
        if (confirm('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
            await supabase.auth.signOut()
        }
    }

    // Auth state change
    supabase.auth.onAuthStateChange((event, session) => {
        if (session) {
            authScreen.style.display = 'none'
            mainApp.classList.add('visible')
            document.getElementById('userEmail').textContent = session.user.email
        } else {
            authScreen.style.display = 'flex'
            mainApp.classList.remove('visible')
        }
    })

    // Check initial session
    const { data: { session } } = await supabase.auth.getSession()
    if (session) {
        authScreen.style.display = 'none'
        mainApp.classList.add('visible')
        document.getElementById('userEmail').textContent = session.user.email
    }
</script>

</body>
</html>